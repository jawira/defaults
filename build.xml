<?xml version="1.0" encoding="UTF-8" ?>

<project name="jawira/skeleton" default="help" phingVersion="3">

  <target name="phpunit" description="Install PHPUnit">
    <composer command="require">
      <arg value="--no-interaction"/>
      <arg value="--no-progress"/>
      <arg value="phpunit/phpunit"/>
      <arg value="--dev"/>
    </composer>
    <mkdir dir=".phpunit.cache"/>
    <mkdir dir="tests"/>
    <copy file="resources/phpunit/demoTest.php" tofile="${application.startdir}/tests/demoTest.php" overwrite="false"/>
    <copy file="resources/phpunit/phpunit.xml.dist" tofile="${application.startdir}/phpunit.xml.dist"
          overwrite="false"/>
    <exec executable="vendor/bin/phpunit" passthru="true">
      <arg value="--migrate-configuration"/>
    </exec>
    <echo level="warning">todo: Add 'tests' dir to 'autoload-dev'</echo>
    <echo level="warning">todo: Add 'phpunit.xml' to '.gitignore'</echo>
    <echo level="warning">todo: Add '.phpunit.cache' to '.gitignore'</echo>
  </target>

  <target name="gitignore" description="Create .gitignore">
    <copy file="resources/gitignore.txt" tofile="${application.startdir}/.gitignore" overwrite="false"/>
  </target>

  <target name="gitattributes" description="Create .gitattributes">
    <copy file="resources/gitattributes.txt" tofile="${application.startdir}/.gitattributes" overwrite="false"/>
  </target>

  <target name="editorconfig" description="Create .editorconfig">
    <copy file="resources/.editorconfig" tofile="${application.startdir}/.editorconfig" overwrite="false"/>
  </target>

  <target name="buildfile" description="Create Phing buildfile">
    <copy file="resources/build.xml" tofile="${application.startdir}/build.xml" overwrite="false"/>
  </target>

  <target name="readme" description="Create Phing buildfile">
    <copy file="resources/README.md" tofile="${application.startdir}/README.md" overwrite="false"/>
  </target>

  <target name="license" description="Create MIT license file">
    <php returnProperty="license.year" expression="date('Y')"/>
    <copy file="resources/LICENSE.md" tofile="${application.startdir}/LICENSE.md" overwrite="false">
      <filterchain>
        <replacetokens>
          <token key="YEAR" value="${license.year}"/>
        </replacetokens>
      </filterchain>
    </copy>
  </target>

  <target name="help">
    <visualizer/>
    <exec executable="xdg-open" spawn="true">
      <arg file="build.png"/>
    </exec>
  </target>

</project>
